# –°–∏—Å—Ç–µ–º–∞ –ö–æ–Ω—Ç—Ä–æ–ª—è - –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—ã–π Backend

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

```bash
cd backend
docker-compose up --build
```

–°–µ—Ä–≤–∏—Å—ã –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã:
- **API Gateway**: http://localhost:3000
- **Service Users**: http://localhost:3001
- **Service Orders**: http://localhost:3002
- **PostgreSQL**: localhost:5432

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

```bash
curl http://localhost:3000/health
```

### 3. –û—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
docker-compose down
```

---

## ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- ‚úÖ API Gateway - –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ, JWT, rate limiting, CORS, —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞
- ‚úÖ Service Users - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –≤—Ö–æ–¥, –ø—Ä–æ—Ñ–∏–ª—å, —Å–ø–∏—Å–æ–∫ (admin)
- ‚úÖ Service Orders - CRUD –∑–∞–∫–∞–∑–æ–≤, –ø–∞–≥–∏–Ω–∞—Ü–∏—è, —Ñ–∏–ª—å—Ç—Ä—ã, –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤
- ‚úÖ PostgreSQL - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
- ‚úÖ JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–∞ –≤—Å–µ—Ö –∑–∞—â–∏—â—ë–Ω–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–∞—Ö
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (Zod)
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ (Pino + X-Request-ID)
- ‚úÖ –î–æ–º–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (EventBus + –∑–∞–≥–æ—Ç–æ–≤–∫–∞ –¥–ª—è –±—Ä–æ–∫–µ—Ä–∞)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
- ‚úÖ –¢—Ä–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è (dev/test/prod)

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã (25+ —Ç–µ—Å—Ç–æ–≤)

```bash
# Service Users
cd service_users && npm install && npm test

# Service Orders
cd service_orders && npm install && npm test
```

**–ß—Ç–æ –ø–æ–∫—Ä—ã–≤–∞—é—Ç:**
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –≤—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- –ó–∞—â–∏—Ç–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤ (—Ç–æ–∫–µ–Ω—ã)
- CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –∑–∞–∫–∞–∑–∞–º–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (—Å–≤–æ–π/—á—É–∂–æ–π –∑–∞–∫–∞–∑)
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è

### E2E —Ç–µ—Å—Ç—ã

```bash
./test-api.sh
```

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª: —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Üí –≤—Ö–æ–¥ ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ ‚Üí –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ ‚Üí –æ—Ç–º–µ–Ω–∞

### Postman

–ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ `docs/postman-collection.json` –≤ Postman –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–ª–ª–µ–∫—Ü–∏—é.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
backend/
‚îú‚îÄ‚îÄ api_gateway/          # –®–ª—é–∑ (–ø–æ—Ä—Ç 3000)
‚îú‚îÄ‚îÄ service_users/        # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (–ø–æ—Ä—Ç 3001)
‚îú‚îÄ‚îÄ service_orders/       # –ó–∞–∫–∞–∑—ã (–ø–æ—Ä—Ç 3002)
‚îú‚îÄ‚îÄ docs/                 # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ openapi.yaml
‚îÇ   ‚îú‚îÄ‚îÄ postman-collection.json
‚îÇ   ‚îú‚îÄ‚îÄ API_EXAMPLES.md
‚îÇ   ‚îú‚îÄ‚îÄ DOMAIN_EVENTS.md
‚îÇ   ‚îî‚îÄ‚îÄ TESTING.md
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ .env.dev / .env.test / .env.prod
‚îî‚îÄ‚îÄ test-api.sh
```

---

## üìã –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¢–ó

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ‚úÖ
- ‚úÖ API Gateway —Å –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- ‚úÖ Service Users —Å JWT
- ‚úÖ Service Orders —Å –ø–æ–ª–Ω—ã–º CRUD
- ‚úÖ PostgreSQL
- ‚úÖ Docker-compose

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è ‚úÖ

**–®–ª—é–∑:**
- ‚úÖ –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ /v1/users ‚Üí service_users
- ‚úÖ –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ /v1/orders ‚Üí service_orders
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ JWT –Ω–∞ –∑–∞—â–∏—â—ë–Ω–Ω—ã—Ö –ø—É—Ç—è—Ö
- ‚úÖ Rate limiting (100 req/15 min)
- ‚úÖ CORS
- ‚úÖ X-Request-ID —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞

**Service Users:**
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –∏ –ø—Ä–æ–≤–µ—Ä–∫–æ–π —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ email
- ‚úÖ –í—Ö–æ–¥ —Å –≤—ã–¥–∞—á–µ–π JWT
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
- ‚úÖ –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è admin (—Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π –∏ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏)

**Service Orders:**
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –ø–æ ID (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø—Ä–∞–≤)
- ‚úÖ –°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
- ‚úÖ –û—Ç–º–µ–Ω–∞ –∑–∞–∫–∞–∑–∞
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –Ω–∞ –∫–∞–∂–¥–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏

### –î–æ–º–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è ‚úÖ
- ‚úÖ –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏—è "—Å–æ–∑–¥–∞–Ω –∑–∞–∫–∞–∑"
- ‚úÖ –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏—è "–æ–±–Ω–æ–≤–ª—ë–Ω —Å—Ç–∞—Ç—É—Å"
- ‚úÖ –ó–∞–≥–æ—Ç–æ–≤–∫–∞ –¥–ª—è –±—Ä–æ–∫–µ—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏–π (RabbitMQ/Kafka)

### –§–æ—Ä–º–∞—Ç API ‚úÖ
- ‚úÖ JSON —Å –ø–æ–ª—è–º–∏ {success, data/error}
- ‚úÖ –û—à–∏–±–∫–∏ —Å {code, message}
- ‚úÖ –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ /v1
- ‚úÖ Authorization: Bearer JWT
- ‚úÖ –ü—É–±–ª–∏—á–Ω—ã–µ —Ç–æ–ª—å–∫–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è/–≤—Ö–æ–¥

### –î–∞–Ω–Ω—ã–µ ‚úÖ
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: id(UUID), email, password_hash, name, roles[], timestamps
- ‚úÖ –ó–∞–∫–∞–∑: id(UUID), user_id, items(JSONB), status(enum), total, timestamps

### –õ–æ–≥–∏ –∏ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ ‚úÖ
- ‚úÖ Pino –≤–æ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö
- ‚úÖ X-Request-ID –≤ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ
- ‚úÖ –õ–æ–≥–∏ —Å user_id, –ø—É—Ç—å, –≤—Ä–µ–º—è, —Å—Ç–∞—Ç—É—Å

### –û–∫—Ä—É–∂–µ–Ω–∏—è ‚úÖ
- ‚úÖ .env.dev
- ‚úÖ .env.test
- ‚úÖ .env.prod

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è ‚úÖ
- ‚úÖ OpenAPI 3.0 —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è (docs/openapi.yaml)
- ‚úÖ Postman –∫–æ–ª–ª–µ–∫—Ü–∏—è —Å —Ç–µ—Å—Ç–∞–º–∏
- ‚úÖ –ü—Ä–∏–º–µ—Ä—ã API (docs/API_EXAMPLES.md)
- ‚úÖ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é (docs/TESTING.md)
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π (docs/DOMAIN_EVENTS.md)

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚úÖ

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:**
- ‚úÖ –£—Å–ø–µ—à–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- ‚úÖ –ü–æ–≤—Ç–æ—Ä–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Üí –æ—à–∏–±–∫–∞
- ‚úÖ –í—Ö–æ–¥ —Å –≤–∞–ª–∏–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ ‚Üí —Ç–æ–∫–µ–Ω
- ‚úÖ –î–æ—Å—Ç—É–ø –±–µ–∑ —Ç–æ–∫–µ–Ω–∞ ‚Üí –æ—Ç–∫–∞–∑

**–ó–∞–∫–∞–∑—ã:**
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ ‚Üí —Å—Ç–∞—Ç—É—Å "created"
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–≤–æ–µ–≥–æ –∑–∞–∫–∞–∑–∞
- ‚úÖ –°–ø–∏—Å–æ–∫ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π

**–ü—Ä–∞–≤–∞:**
- ‚úÖ –ü–æ–ø—ã—Ç–∫–∞ –æ–±–Ω–æ–≤–∏—Ç—å —á—É–∂–æ–π –∑–∞–∫–∞–∑ ‚Üí –æ—Ç–∫–∞–∑
- ‚úÖ –û—Ç–º–µ–Ω–∞ —Å–≤–æ–µ–≥–æ –∑–∞–∫–∞–∑–∞ ‚Üí —Å—Ç–∞—Ç—É—Å "cancelled"
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–æ—á–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤

**–ò—Ç–æ–≥–æ:** 25+ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Å—Ç–æ–≤ (Jest) + Postman –∫–æ–ª–ª–µ–∫—Ü–∏—è + E2E bash-—Å–∫—Ä–∏–ø—Ç

---

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- Node.js 18 + Express
- PostgreSQL 15
- Docker & Docker Compose
- JWT (jsonwebtoken)
- Pino (–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
- Zod (–≤–∞–ª–∏–¥–∞—Ü–∏—è)
- Jest + Supertest (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- Express Rate Limit
- CORS

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **OpenAPI**: `docs/openapi.yaml` - –ø–æ–ª–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è API
- **–ü—Ä–∏–º–µ—Ä—ã**: `docs/API_EXAMPLES.md` - curl –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è –≤—Å–µ—Ö endpoints
- **–°–æ–±—ã—Ç–∏—è**: `docs/DOMAIN_EVENTS.md` - –æ–ø–∏—Å–∞–Ω–∏–µ –¥–æ–º–µ–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
- **–¢–µ—Å—Ç—ã**: `docs/TESTING.md` - —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
- **Postman**: `docs/postman-collection.json` - –∫–æ–ª–ª–µ–∫—Ü–∏—è –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞

---

## üéØ –ò—Ç–æ–≥

‚úÖ –í—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã  
‚úÖ –í—Å–µ –∑–∞–¥–∞–Ω–∏—è —Å–æ –∑–≤—ë–∑–¥–æ—á–∫–æ–π –≤—ã–ø–æ–ª–Ω–µ–Ω—ã (–ª–æ–≥–∏, —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞, —Å–æ–±—ã—Ç–∏—è)  
‚úÖ –í—Å–µ —Ç–µ—Å—Ç-–∫–µ–π—Å—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã  
‚úÖ –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
